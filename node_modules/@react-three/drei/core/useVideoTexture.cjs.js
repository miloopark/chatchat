"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("three"),t=require("react"),r=require("@react-three/fiber"),n=require("suspend-react"),o=require("hls.js");function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function s(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var c=s(e),i=u(o);exports.useVideoTexture=function(e,o){const{unsuspend:u,start:s,crossOrigin:a,muted:d,loop:l,hls:f,...p}={unsuspend:"loadedmetadata",crossOrigin:"Anonymous",muted:!0,loop:!0,start:!0,playsInline:!0,hls:{},...o},g=new URL("string"==typeof e?e:"",window.location.href).pathname.endsWith(".m3u8")&&i.default.isSupported(),m=t.useRef(g?new i.default({...f}):null),O=t.useRef(null),b=r.useThree((e=>e.gl)),y=n.suspend((()=>new Promise(((t,r)=>{const n=Object.assign(document.createElement("video"),{src:"string"==typeof e&&e||void 0,srcObject:e instanceof MediaStream&&e||void 0,crossOrigin:a,loop:l,muted:d,...p});if(O.current=n,"string"==typeof e)if(g){const t=m.current;t&&(t.attachMedia(n),t.on(i.default.Events.MEDIA_ATTACHED,(()=>{t.loadSource(e)})))}else n.src=e;else e instanceof MediaStream&&(n.srcObject=e);const o=new c.VideoTexture(n);"colorSpace"in o?o.colorSpace=b.outputColorSpace:o.encoding=b.outputEncoding,n.addEventListener(u,(()=>t(o)))}))),[e]);return t.useEffect((()=>(s&&y.image.play(),()=>{m.current&&(m.current.destroy(),m.current=null)})),[y,s]),y};
